<!DOCTYPE html> <!-- HTML5文档类型声明，告诉浏览器这是HTML5文档 -->
<html lang="zh-CN"> <!-- HTML根元素，lang属性指定页面语言为中文 -->

<head> <!-- 头部区域，包含页面元数据 -->
    <meta charset="UTF-8"> <!-- 设置字符编码为UTF-8，支持中文显示 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- 响应式设计，设置视口宽度等于设备宽度 -->
    <title>购物车 | TechNova</title> <!-- 页面标题，显示在浏览器标签页 -->
    <link rel="stylesheet" href="css/style-base.css"> <!-- 引用基础样式文件，包含通用样式 -->
    <link rel="stylesheet" href="css/style-cart.css"> <!-- 引用购物车页面专用样式文件 -->
</head> <!-- 头部区域结束 -->

<body> <!-- 页面主体开始 -->

    <!-- ========== 导航栏 ========== --> <!-- HTML注释：导航栏区域标识 -->
    <nav class="navbar"> <!-- 导航栏容器，使用navbar样式类 -->
        <div class="container nav-content"> <!-- 导航内容容器，限制最大宽度并居中 -->
            <a href="index-simple.html" class="logo">TechNova</a> <!-- 网站Logo链接，点击返回首页 -->

            <div class="nav-menu" id="nav-menu"> <!-- 导航菜单容器，设置ID用于JavaScript控制 -->
                <a href="index-simple.html">首页</a> <!-- 首页链接 -->
                <a href="shop-simple.html">商城</a> <!-- 商城页面链接 -->
                <a href="about-simple.html">关于我们</a> <!-- 关于我们页面链接 -->
            </div> <!-- 导航菜单容器结束 -->
            <div class="nav-right"> <!-- 右侧功能区容器 -->
                <div class="hamburger" onclick="toggleMenu()"> <!-- 汉堡菜单按钮，点击时调用toggleMenu函数 -->
                    <span></span> <!-- 汉堡菜单第一条线 -->
                    <span></span> <!-- 汉堡菜单第二条线 -->
                    <span></span> <!-- 汉堡菜单第三条线 -->
                </div> <!-- 汉堡菜单按钮结束 -->
                <a href="login-simple.html">登录</a> <!-- 登录页面链接 -->
                <a href="cart-simple.html" style="color: #ff4d4f; font-weight: bold;"> <!-- 购物车页面链接，设置为红色粗体表示当前页面 -->
                    购物车 <span class="cart-count" id="cart-count">0</span> <!-- 购物车文字和数量显示，ID用于JavaScript更新数量 -->
                </a> <!-- 购物车链接结束 -->
            </div> <!-- 右侧功能区容器结束 -->
        </div> <!-- 导航内容容器结束 -->
    </nav> <!-- 导航栏容器结束 -->

    <div class="container" style="min-height: 60vh;"> <!-- 主要内容容器，设置最小高度为60%视口高度 -->

        <h1 class="cart-title"> 我的购物车</h1> <!-- 一级标题，购物车页面主标题 -->

        <!-- 购物车内容区域 --> <!-- HTML注释：购物车内容区域说明 -->
        <div id="cart-content"> <!-- 购物车内容容器，ID用于JavaScript控制显示/隐藏 -->

            <!-- 购物车表格 --> <!-- HTML注释：购物车表格说明 -->
            <table class="cart-table"> <!-- 购物车表格，使用cart-table样式类 -->
                <thead> <!-- 表格头部 -->
                    <tr> <!-- 表格头部行 -->
                        <th>商品信息</th> <!-- 表格头部单元格：商品信息列 -->
                        <th>单价</th> <!-- 表格头部单元格：单价列 -->
                        <th>数量</th> <!-- 表格头部单元格：数量列 -->
                        <th>操作</th> <!-- 表格头部单元格：操作列 -->
                    </tr> <!-- 表格头部行结束 -->
                </thead> <!-- 表格头部结束 -->
                <tbody id="cart-items"> <!-- 表格主体，ID用于JavaScript动态填充内容 -->
                    <!-- JavaScript动态填充 --> <!-- HTML注释：说明此处内容由JavaScript动态生成 -->
                </tbody> <!-- 表格主体结束 -->
            </table> <!-- 购物车表格结束 -->

            <!-- 结算区域 --> <!-- HTML注释：结算区域说明 -->
            <div class="cart-summary"> <!-- 结算摘要容器 -->
                <span class="total-label">总计:</span> <!-- 总计标签文字 -->
                <span class="total-amount" id="total-price">¥0</span> <!-- 总价显示，ID用于JavaScript更新价格 -->
                <div style="margin-top: 15px;"> <!-- 按钮容器，设置顶部外边距 -->
                    <button class="btn" onclick="checkout()">立即结算</button> <!-- 结算按钮，点击时调用checkout函数 -->
                </div> <!-- 按钮容器结束 -->
            </div> <!-- 结算摘要容器结束 -->

        </div> <!-- 购物车内容容器结束 -->

        <!-- 购物车为空时显示 --> <!-- HTML注释：空购物车状态说明 -->
        <div id="empty-cart" class="empty-state" style="display: none;"> <!-- 空购物车容器，默认隐藏，ID用于JavaScript控制显示 -->
            <p class="empty-text">购物车是空的</p> <!-- 空购物车提示文字 -->
            <a href="shop-simple.html" class="btn">去选购商品</a> <!-- 去购物按钮，链接到商城页面 -->
        </div> <!-- 空购物车容器结束 -->

    </div> <!-- 主要内容容器结束 -->

    <footer class="footer"> <!-- 页脚容器 -->
        <p>© 2025 TechNova 科技商城 </p> <!-- 版权信息文字 -->
    </footer> <!-- 页脚容器结束 -->

    <script> /* JavaScript代码开始 */
        // ===== 汉堡菜单切换 ===== /* JavaScript单行注释：汉堡菜单功能说明 */
        function toggleMenu() { /* 定义汉堡菜单切换函数 */
            var menu = document.getElementById('nav-menu'); /* 获取导航菜单元素，通过ID选择器 */
            menu.classList.toggle('active'); /* 切换菜单的active类，用于显示/隐藏菜单 */
        } /* 汉堡菜单切换函数结束 */

        // ===== 渲染购物车 ===== /* JavaScript单行注释：渲染购物车功能说明 */
        function renderCart() { /* 定义渲染购物车函数 */
            // 获取购物车数据 /* JavaScript单行注释：从本地存储获取购物车数据 */
            var cart = JSON.parse(localStorage.getItem('cart')) || []; /* 从localStorage获取购物车数据，如果为空则初始化为空数组 */

            // 获取页面元素 /* JavaScript单行注释：获取页面中需要操作的DOM元素 */
            var cartContent = document.getElementById('cart-content'); /* 获取购物车内容容器元素 */
            var emptyCart = document.getElementById('empty-cart'); /* 获取空购物车提示容器元素 */
            var cartItems = document.getElementById('cart-items'); /* 获取购物车商品列表容器元素 */
            var totalPrice = document.getElementById('total-price'); /* 获取总价显示元素 */

            // 如果购物车为空 /* JavaScript单行注释：处理购物车为空的情况 */
            if (cart.length === 0) { /* 检查购物车是否为空 */
                cartContent.style.display = 'none'; /* 隐藏购物车内容区域 */
                emptyCart.style.display = 'block'; /* 显示空购物车提示 */
                return; /* 结束函数执行 */
            } /* 条件判断结束 */

            // 购物车有商品 /* JavaScript单行注释：处理购物车有商品的情况 */
            cartContent.style.display = 'block'; /* 显示购物车内容区域 */
            emptyCart.style.display = 'none'; /* 隐藏空购物车提示 */

            // 清空表格内容 /* JavaScript单行注释：清空之前的表格内容 */
            cartItems.innerHTML = ''; /* 清空购物车商品列表的HTML内容 */

            // 计算总价 /* JavaScript单行注释：初始化总价计算 */
            var total = 0; /* 定义总价变量，初始值为0 */

            // 遍历购物车，生成表格行 /* JavaScript单行注释：循环处理每个购物车商品 */
            for (var i = 0; i < cart.length; i++) { /* 遍历购物车中的所有商品 */
                var item = cart[i]; /* 获取当前商品对象 */
                total = total + (item.price * item.quantity); /* 计算当前商品的总价并累加到总价中 */

                // 创建表格行HTML /* JavaScript单行注释：动态生成表格行的HTML代码 */
                var row = '<tr>'; /* 开始创建表格行 */
                row += '<td>'; /* 开始商品信息单元格 */
                row += '<div class="item-info">'; /* 商品信息容器 */
                row += '<img src="' + item.image + '" class="item-img">'; /* 商品图片，使用商品的图片路径 */
                row += '<div>'; /* 商品文字信息容器 */
                row += '<div class="item-name">' + item.name + '</div>'; /* 商品名称显示 */
                row += '<div class="item-cat">' + item.category + '</div>'; /* 商品分类显示 */
                row += '</div>'; /* 商品文字信息容器结束 */
                row += '</div>'; /* 商品信息容器结束 */
                row += '</td>'; /* 商品信息单元格结束 */
                row += '<td class="price-text">¥' + item.price.toLocaleString() + '</td>'; /* 单价单元格，使用toLocaleString()格式化数字 */
                row += '<td>'; /* 数量控制单元格开始 */
                row += '<div class="qty-control">'; /* 数量控制容器 */
                row += '<button class="qty-btn" onclick="changeQuantity(' + item.id + ', -1)">-</button>'; /* 减少数量按钮，点击时调用changeQuantity函数 */
                row += '<span class="qty-num">' + item.quantity + '</span>'; /* 当前数量显示 */
                row += '<button class="qty-btn" onclick="changeQuantity(' + item.id + ', 1)">+</button>'; /* 增加数量按钮，点击时调用changeQuantity函数 */
                row += '</div>'; /* 数量控制容器结束 */
                row += '</td>'; /* 数量控制单元格结束 */
                row += '<td>'; /* 操作单元格开始 */
                row += '<button class="del-btn" onclick="removeItem(' + item.id + ')">删除</button>'; /* 删除按钮，点击时调用removeItem函数 */
                row += '</td>'; /* 操作单元格结束 */
                row += '</tr>'; /* 表格行结束 */

                cartItems.innerHTML += row; /* 将生成的表格行HTML添加到购物车商品列表中 */
            } /* 循环结束 */

            // 显示总价 /* JavaScript单行注释：更新总价显示 */
            totalPrice.innerText = '¥' + total.toLocaleString(); /* 设置总价显示文本，使用toLocaleString()格式化数字 */

            // 更新购物车数量 /* JavaScript单行注释：更新导航栏购物车数量显示 */
            updateCartCount(); /* 调用更新购物车数量函数 */
        } /* 渲染购物车函数结束 */

        // ===== 修改商品数量 ===== /* JavaScript单行注释：修改商品数量功能说明 */
        function changeQuantity(id, change) { /* 定义修改商品数量函数，接收商品ID和变化量参数 */
            var cart = JSON.parse(localStorage.getItem('cart')) || []; /* 从localStorage获取购物车数据，如果为空则初始化为空数组 */

            for (var i = 0; i < cart.length; i++) { /* 遍历购物车中的所有商品 */
                if (cart[i].id === id) { /* 如果找到指定ID的商品 */
                    cart[i].quantity = cart[i].quantity + change; /* 修改商品数量，增加或减少指定的变化量 */

                    // 如果数量小于等于0，删除该商品 /* JavaScript单行注释：处理数量为0或负数的情况 */
                    if (cart[i].quantity <= 0) { /* 检查商品数量是否小于等于0 */
                        cart.splice(i, 1); /* 从购物车数组中删除该商品 */
                    } /* 条件判断结束 */
                    break; /* 跳出循环 */
                } /* 条件判断结束 */
            } /* 循环结束 */

            localStorage.setItem('cart', JSON.stringify(cart)); /* 将修改后的购物车数据保存到localStorage */
            renderCart(); /* 重新渲染购物车页面 */
        } /* 修改商品数量函数结束 */

        // ===== 删除商品 ===== /* JavaScript单行注释：删除商品功能说明 */
        function removeItem(id) { /* 定义删除商品函数，接收商品ID参数 */
            if (confirm('确定要删除这个商品吗？')) { /* 显示确认对话框，询问用户是否确定删除 */
                var cart = JSON.parse(localStorage.getItem('cart')) || []; /* 从localStorage获取购物车数据，如果为空则初始化为空数组 */

                for (var i = 0; i < cart.length; i++) { /* 遍历购物车中的所有商品 */
                    if (cart[i].id === id) { /* 如果找到指定ID的商品 */
                        cart.splice(i, 1); /* 从购物车数组中删除该商品 */
                        break; /* 跳出循环 */
                    } /* 条件判断结束 */
                } /* 循环结束 */

                localStorage.setItem('cart', JSON.stringify(cart)); /* 将修改后的购物车数据保存到localStorage */
                renderCart(); /* 重新渲染购物车页面 */
            } /* 条件判断结束 */
        } /* 删除商品函数结束 */

        // ===== 结算 ===== /* JavaScript单行注释：结算功能说明 */
        function checkout() { /* 定义结算函数 */
            if (confirm('确定要结算吗？（模拟支付）')) { /* 显示确认对话框，询问用户是否确定结算 */
                // 清空购物车 /* JavaScript单行注释：清空购物车数据 */
                localStorage.removeItem('cart'); /* 从localStorage中删除购物车数据 */
                alert('支付成功！感谢您的购买！'); /* 显示支付成功提示 */
                window.location.href = 'index-simple.html'; /* 跳转到首页 */
            } /* 条件判断结束 */
        } /* 结算函数结束 */

        // ===== 更新购物车数量 ===== /* JavaScript单行注释：更新购物车数量功能说明 */
        function updateCartCount() { /* 定义更新购物车数量显示函数 */
            var cart = JSON.parse(localStorage.getItem('cart')) || []; /* 从localStorage获取购物车数据，如果为空则初始化为空数组 */
            var total = 0; /* 定义总数量变量，初始值为0 */
            for (var i = 0; i < cart.length; i++) { /* 遍历购物车中的所有商品 */
                total = total + cart[i].quantity; /* 累加每个商品的数量到总数量 */
            } /* 循环结束 */
            document.getElementById('cart-count').innerText = total; /* 获取购物车数量显示元素并更新其文本内容 */
        } /* 更新购物车数量显示函数结束 */

        // ===== 页面加载时渲染购物车 ===== /* JavaScript单行注释：页面加载事件说明 */
        window.onload = function () { /* 设置页面加载完成时的事件处理函数 */
            renderCart(); /* 调用渲染购物车函数 */
        }; /* 页面加载事件处理函数结束 */
    </script> <!--  JavaScript代码结束  -->

</body> <!-- 页面主体结束 -->

</html> <!-- HTML文档结束 -->